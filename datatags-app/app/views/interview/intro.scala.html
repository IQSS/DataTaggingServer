@(qKit: PolicyModelVersionKit, interviewWelcomeMessage:Option[String])(implicit req:Request[_])

@scripts = {
  <script type="text/javascript" src="@routes.Assets.at("js/InterviewIntro.js")"></script>
}
@templates.bsNavBar("Interview Start Page", 'tag, scripts) {
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <a href="@routes.Application.showVersionedPolicyModel(qKit.id.modelId)"><i class="fa fa-list"></i> Model Versions</a>
      <h3>
        @qKit.model.getMetadata.getTitle
      </h3>
      @if( qKit.model.getMetadata.getSubTitle!=null && qKit.model.getMetadata.getSubTitle.nonEmpty) {
        <p>@qKit.model.getMetadata.getSubTitle</p>
      }
    </div>
  </div>
  @for( iwm <- interviewWelcomeMessage ) {
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <div class="welcomeMessage">
          @iwm
        </div>
      </div>
    </div>
  }
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      @if( qKit.canRun ) {
        <div class="well well-lg">
          <div class="text-center">
            <div class="row">
              <div class="col-xs--12">
                @if( qKit.model.getLocalizations.size>1 ) {
                  @for( locName <- qKit.model.getLocalizations ) {
                    <a href="@routes.InterviewCtrl.startInterview(qKit.id.modelId, qKit.id.version, Some(locName))"
                     class="btn btn-primary btn-lg">Begin Questionnaire (@locName)</a>
                  }
                } else {
                  <a href="@routes.InterviewCtrl.startInterview(qKit.id.modelId, qKit.id.version)"
                  class="btn btn-primary btn-lg">Begin Questionnaire</a>
                }
              </div>
            </div>
          </div>
        </div>
      }else{
        <div class="alert alert-danger">
          <strong>This model has errors</strong> and thus we cannot use it to conduct an interview. See the System Messages section below.
        </div>
      }
      @if( qKit.messages.nonEmpty ){
        <h3>System Messages</h3>
        <ul>
        @comps.kitMessageList(qKit.messages)
        </ul>
      }
      @defining( qKit.availableVisualizations ) { avz =>
        @if( avz.hasData){
          <h3>Visualizations</h3>
          <div class="row">
            <div class="col-md-6">
              @if( avz.decisionGraph.nonEmpty ) {
                <strong>Decision Graph:</strong>
                <ul class="visualizationList">
                  @for(p <- avz.decisionGraph) {
                    <li><a href="@routes.Application.visualizationFile(qKit.id.modelId + "/" + qKit.id.version + "/" + p.getFileName)">@p.getFileName.toString.split("\\.").last</a></li>
                  }
                </ul>
              }
            </div>
            <div class="col-md-6">
              @if( avz.policySpace.nonEmpty ) {
                <strong>Policy Space:</strong>
                <ul class="visualizationList">
                  @for(p <- avz.policySpace) {
                    <li><a href="@routes.Application.visualizationFile(qKit.id.modelId + "/" + qKit.id.version + "/" + p.getFileName)">@p.getFileName.toString.split("\\.").last</a></li>
                  }
                </ul>
              }
            </div>
          </div>
        }
      }
      <h3>Metadata</h3>
      @defining( qKit.model.getMetadata ) { md =>
        <table class="table">
          <tbody>
            @if( md.getAuthors.size > 0 ) {
              <tr>
                <th>Authors</th>
                <td>
                  <ul class="authorList">
                    @for( a<-md.getAuthors ){<li>@comps.author(a)</li>}
                  </ul>
                </td>
              </tr>
            }
            @for( doi <- Option(md.getDoi) ) {
              <tr>
                <th>DOI</th>
                <td>@doi</td>
              </tr>
            }
            @for( version <- Option(md.getVersion) ) {
              <tr>
                <th>Version</th>
                <td>@version</td>
              </tr>
            }
            @for( rd <- Option(md.getReleaseDate) ) {
              <tr>
                <th>Released</th>
                <td>@rd</td>
              </tr>
            }
            @if( md.getKeywords.size > 0 ) {
              <tr>
                <th>Keywords</th>
                <td>@md.getKeywords.asScala.mkString(", ")</td>
              </tr>
            }
            @if( md.getReferences.size > 0 ) {
              <tr>
                <th>References</th>
                <td>
                  <ul>
                    @for( ref <- md.getReferences ) {
                      <li>
                        <h6>
                          @for(url<-Option(ref.getUrl)){
                            <a href="@url" target="_blank">@url</a>}
                          @for(doi<-Option(ref.getDoi)){ (doi:@doi)}
                        </h6>
                        @ref.getText
                      </li>
                    }
                  </ul>
                </td>
              </tr>
            }

          </tbody>
        </table>
      }

      <h3>Policy Space</h3>
      <p>
        The chart below displays the range of tags that may be suggested at the conclusion of the interview.
        These tags cover properties such as the regulatory classification of the information, the sensitivity of the information,
        the terms of governing contractual agreements, and the appropriate data security and other handling requirements.
        Hover/touch the <i class="glyphicon glyphicon-info-sign"></i> icons, where available, to see a short explanation about specific values.
      </p>

      @comps.tagType(qKit.model.getSpaceRoot, None)

    </div>
  </div>
}
