@import edu.harvard.iq.datatags.externaltexts.Localization
@( pmvKit: PolicyModelVersionKit,
   questionNode: edu.harvard.iq.datatags.model.graphs.nodes.AskNode,
   dataTags: edu.harvard.iq.datatags.model.values.CompoundValue,
   history:Seq[edu.harvard.iq.datatags.model.graphs.nodes.Node],
   answerHistory: Seq[AnswerRecord],
   loc:Option[Localization], noteOpt:Boolean, note:Option[String]
)(implicit req:Request[_])

@scripts = {
    <script type="text/javascript" src="@routes.Application.javascriptRoutes"></script>
    <script type="text/javascript" src="@routes.Assets.at("js/Question.js")"></script>
}

@import views.Helpers

@templates.bsNavBar( "Question", 'tag, scripts) {
  <div class="row">
    <div class="col">
      <a href="@routes.InterviewCtrl.startInterview(pmvKit.id.modelId, pmvKit.id.version, loc.map(_.getLanguage))">
        <i class="fa fa-arrow-left"></i> Intro
      </a>
      <br>
    </div>
  </div>
  <div class="row">
    <div class="col">
     @comps.questionPanel(
       questionNode, pmvKit, loc, answerHistory, pmvKit.dbData.commentingStatus != CommentingStatus.Closed, interactive=true, showId = false, noteOpt, note
     )
    </div>
  </div>
<div class="row">
  <div class="col-md">
      <div class="card m-2">
          <div class="card-header bg-info text-white">
              Answer Feed
          </div>
          <div class="card-body">
              @if( answerHistory.nonEmpty ) {
                  @comps.answerHistory(answerHistory, pmvKit.id, reverse=true, pmvKit.serializer, loc)
              } else {
                  <div class="well well-sm text-center">
                      <span class="muted small">This space will contain your answers, and will allow you to revisit them when needed.</span>
                  </div>
              }
          </div>
      </div>
  </div>
  <div class="col-md">
      <div class="card m-2">
          <div class="card-header bg-info text-white">
              Current Tags
          </div>
          <div class="card-body">
              <ul class="list-unstyled">
                  @if( dataTags.getNonEmptySubSlots.isEmpty ) {
                      <div class="well well-sm text-center">
                          <span class="muted small">This space will contain the resultant policy. It will be updated as we go along.</span>
                      </div>
                  } else {
                      @comps.tagValue(dataTags, loc)
                  }
              </ul>
          </div>
      </div>
  </div>
</div>
<div class="row">
  <div class="col">
      <div class="card m-2">
          <div class="card-header text-muted">
              Engine Trace
              <small>Useful for debugging an interview, but not very useful otherwise</small>
          </div>
          <div class="card-body">
              <div class="engine-trace-container">
                  <table class="engine-trace">
                      <thead>
                          <tr>
                              <th>Id</th>
                              <th>Type</th>
                              <th>Info</th>
                          </tr>
                      </thead>
                      <tbody>
                      @for( nd <- history.reverse ){
                          <tr>
                              @comps.node(nd)
                          </tr>
                      }
                      </tbody>
                  </table>
              </div>
          </div>
      </div>
  </div>
</div>
}
